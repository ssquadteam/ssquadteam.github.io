<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Flappy Bird Game</title>
<style>
  body { margin: 0; overflow: hidden; }
  canvas { display: block; background-color: #4ec0ca; }
  #score { font-size: 24px; text-align: center; }
</style>
</head>
<body>

<canvas id="gameCanvas"></canvas>

<script>
var canvas = document.getElementById('gameCanvas');
var ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

var bird = {
  x: 50,
  y: canvas.height / 2,
  width: 40,
  height: 40,
  gravity: 0.25, // Slower gravity
  lift: -6,
  velocity: 0
};

var pipes = [];
var pipeWidth = 80;
var pipeGap = 150;
var pipeFrequency = 2000; // Slower pipe generation
var lastPipeTime = 0;

var score = 0;
var highScore = parseInt(localStorage.getItem('highScore')) || 0;

var gameRunning = false;

function updateBird() {
  bird.velocity += bird.gravity;
  bird.y += bird.velocity;

  if (bird.y >= canvas.height - bird.height || bird.y <= 0) {
    gameOver();
  }
}

function updatePipes() {
  if (Date.now() - lastPipeTime > pipeFrequency) {
    var pipeHeight = Math.random() * (canvas.height / 2);
    pipes.push({ x: canvas.width, y: 0, height: pipeHeight });
    lastPipeTime = Date.now();
  }

  pipes.forEach(function(pipe, index) {
    pipe.x -= 3; // Slower pipe movement

    if (pipe.x + pipeWidth < 0) {
      pipes.splice(index, 1);
      score++;
      highScore = Math.max(score, highScore);
      localStorage.setItem('highScore', highScore.toString());
    }
  });
}

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // Draw bird
  ctx.fillStyle = 'yellow';
  ctx.fillRect(bird.x, bird.y, bird.width, bird.height);

  // Draw pipes
  ctx.fillStyle = 'green';
  pipes.forEach(function(pipe) {
    ctx.fillRect(pipe.x, pipe.y, pipeWidth, pipe.height);
    ctx.fillRect(pipe.x, pipe.height + pipeGap, pipeWidth, canvas.height - pipe.height - pipeGap);
  });

  // Draw score
  ctx.fillStyle = 'white';
  ctx.font = '40px Arial';
  ctx.fillText('Score: ' + score, 20, 50);
  ctx.fillText('High Score: ' + highScore, 20, 100);
}

function gameOver() {
  gameRunning = false;
  bird.y = canvas.height / 2;
  bird.velocity = 0;
  pipes = [];
  score = 0;
  lastPipeTime = Date.now() - pipeFrequency;
  // The game will wait for the next tap or click to restart
}

function gameLoop() {
  if (gameRunning) {
    updateBird();
    updatePipes();
  }
  draw();
  requestAnimationFrame(gameLoop);
}

canvas.addEventListener('click', function() {
  if (!gameRunning) {
    gameRunning = true;
    score = 0;
  } else {
    bird.velocity += bird.lift;
  }
});

canvas.addEventListener('touchstart', function(e) {
  e.preventDefault();
  if (!gameRunning) {
    gameRunning = true;
    score = 0;
  } else {
    bird.velocity += bird.lift;
  }
}, false);

requestAnimationFrame(gameLoop);
</script>

</body>
</html>
